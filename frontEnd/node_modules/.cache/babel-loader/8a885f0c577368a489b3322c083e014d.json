{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/carmelklein/GitProjects/FullStackProject/frontEnd/src/Components/AllMovies.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useRef } from 'react';\nimport axios from 'axios';\nimport { BrowserRouter as Router, Link, Switch, Route } from 'react-router-dom';\nimport { useHistory } from \"react-router-dom\";\nimport AllMembers from './AllMembers';\n\nconst AllMovies = () => {\n  _s();\n\n  const [movies, setMovies] = useState([]);\n  const [subscriptions, setSubscriptions] = useState([]);\n  const [members, setMembers] = useState([]);\n  let history = useHistory();\n  const find = useRef(null);\n  const [updateAxios, setUpdateAxios] = useState(false);\n  useEffect(async () => {\n    axios.get('http://localhost:4000/routingToFront/moviesToClient').then(x => {\n      setMovies(x.data);\n    }).catch(error => {\n      console.log(error);\n    }); //getting the subscriptions from the Web Service(DB)\n\n    axios.get('http://localhost:4000/routingToFront/subscriptionToClient').then(x => {\n      setSubscriptions(x.data);\n    }); //getting the members from the Web Service\n\n    axios.get('http://localhost:4000/routingToFront/membersToClient').then(x => {\n      setMembers(x.data);\n    }); //permissions:\n\n    axios.get('http://localhost:4000/routingToFront/UsersDBFullData').then(allUsers => {\n      return allUsers.data.forEach(user => {\n        if (user.userName === sessionStorage[\"user\"]) {\n          return user.permissions.forEach(p => {\n            if (p === \"Update Movie\") {\n              setUpdateAxios(true);\n            }\n          });\n        }\n      });\n    });\n  }, []);\n\n  const subscriptionWatched = (index, item) => {\n    return subscriptions.map(s => {\n      return s.Movies.map(movies => {\n        if (movies.movieName === item.Name) {\n          return members.map(m => {\n            if (s.MemberId === m._id) {\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/main/Subscriptions/AllMembers\",\n                  children: m.Name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 62,\n                  columnNumber: 50\n                }, this), \", \", movies.date]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 62,\n                columnNumber: 32\n              }, this);\n            }\n          });\n        }\n      });\n    });\n  };\n\n  function handleEdit(id, name) {\n    if (updateAxios === true) {\n      history.push(\"/main/movies/EditMovie/\" + id + \"/\" + name);\n    } else {}\n  }\n\n  function handleDelete(id, name) {\n    //delete the movie\n    axios.delete('http://localhost:8000/routingToCinemaWS/deleteMovie/' + id); //delete the movie's subscriptions(only the movie)==> (update)\n    //the code if's - if the movies fount out in one of the subscribers pass only the other movies of the same subscriber\n\n    let arrOfNotSubscribe = [];\n    let mId = \"\";\n    let subId = \"\";\n    subscriptions.forEach(s => {\n      s.Movies.forEach(m => {\n        if (m.movieName === name) {\n          s.Movies.forEach(x => {\n            if (x.movieName !== name) {\n              mId = s.MemberId;\n              subId = s._id;\n              arrOfNotSubscribe.push({\n                movieName: x.movieName,\n                date: x.date\n              });\n            }\n          });\n        }\n      });\n    });\n    const unsubscribeMovie = {\n      movies: arrOfNotSubscribe,\n      memberId: mId\n    };\n    console.log(arrOfNotSubscribe);\n    axios.put('http://localhost:8000/routingToCinemaWS/editSubscription/' + subId, unsubscribeMovie).then(resp => console.log(resp)); //reload the page because of the changes\n\n    window.location.reload(false);\n  }\n\n  const findMovie = () => {\n    // console.log(find.current.value)\n    let arr = [];\n    movies.forEach(x => {\n      var n = x.Name.startsWith(find.current.value);\n\n      if (n === true) {\n        arr.push(x);\n      }\n    });\n    setMovies(arr);\n  };\n\n  const getOnlyYear = date => {\n    let x = date.slice(0, 4);\n    return x;\n  };\n\n  let items = movies.map((item, index) => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w3-blue w3-hover-shadow w3-padding-32 w3-bordered w3-code\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"block\"\n        },\n        children: [item.Name, \", \", getOnlyYear(item.Premiered), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 51\n        }, this), \"Genres: \", item.Genres.join(\",\"), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 42\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 47\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: item.Image,\n        alt: \"movies\",\n        style: {\n          display: \"inline\",\n          height: \"250px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w3-green w3-hover-shadow w3-padding-32 w3-bordered w3-code\",\n        style: {\n          border: \"3px solid\",\n          display: \"inline-block\",\n          width: \"660px\",\n          marginLeft: \"10px\"\n        },\n        children: [\"Subscriptions watched\", /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: subscriptionWatched(index, item)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          children: /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/main/Subscriptions/AllMembers\",\n            component: AllMembers\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        value: \"Edit\",\n        onClick: () => handleEdit(item._id, item.Name)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        value: \"Delete\",\n        onClick: () => handleDelete(item._id, item.Name)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 11\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 16\n    }, this);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"Find Movie: \", /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"find\",\n      ref: find\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"button\",\n      value: \"Find\",\n      onClick: findMovie\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 8\n    }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 69\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 74\n    }, this), items]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 8\n  }, this);\n};\n\n_s(AllMovies, \"CvoGoeTBAPlP/HXOFceLG+DA1q4=\", false, function () {\n  return [useHistory];\n});\n\n_c = AllMovies;\nexport default AllMovies;\n\nvar _c;\n\n$RefreshReg$(_c, \"AllMovies\");","map":{"version":3,"sources":["/Users/carmelklein/GitProjects/FullStackProject/frontEnd/src/Components/AllMovies.js"],"names":["useEffect","useState","useRef","axios","BrowserRouter","Router","Link","Switch","Route","useHistory","AllMembers","AllMovies","movies","setMovies","subscriptions","setSubscriptions","members","setMembers","history","find","updateAxios","setUpdateAxios","get","then","x","data","catch","error","console","log","allUsers","forEach","user","userName","sessionStorage","permissions","p","subscriptionWatched","index","item","map","s","Movies","movieName","Name","m","MemberId","_id","date","handleEdit","id","name","push","handleDelete","delete","arrOfNotSubscribe","mId","subId","unsubscribeMovie","memberId","put","resp","window","location","reload","findMovie","arr","n","startsWith","current","value","getOnlyYear","slice","items","display","Premiered","Genres","join","Image","height","border","width","marginLeft"],"mappings":"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","sourcesContent":["import {useEffect, useState, useRef} from 'react'\nimport axios from 'axios'\nimport {BrowserRouter as Router, Link , Switch, Route} from 'react-router-dom'\nimport { useHistory } from \"react-router-dom\";\nimport AllMembers from './AllMembers'\n\nconst AllMovies  = () =>\n{\n    const [movies, setMovies] = useState([])\n    const [subscriptions,setSubscriptions] = useState([])\n    const [members,setMembers] = useState([])\n    let history = useHistory();\n    const find = useRef(null)\n    const [updateAxios,setUpdateAxios] = useState(false)\n\n    \n    useEffect(async () => {\n        axios.get('http://localhost:4000/routingToFront/moviesToClient')\n        .then(x=>{(setMovies(x.data))}).catch(error => {console.log(error)}) \n\n       //getting the subscriptions from the Web Service(DB)\n       axios.get('http://localhost:4000/routingToFront/subscriptionToClient')\n       .then(x=>{setSubscriptions(x.data)})\n\n      //getting the members from the Web Service\n      axios.get('http://localhost:4000/routingToFront/membersToClient')\n      .then(x=>{setMembers(x.data)})\n\n      //permissions:\n      axios.get('http://localhost:4000/routingToFront/UsersDBFullData')\n      .then((allUsers)=>{ \n          return allUsers.data.forEach(user =>\n                {\n                  if(user.userName === sessionStorage[\"user\"])\n                  {\n                      return user.permissions.forEach(p=>\n                          {\n                              if(p === \"Update Movie\")\n                              {\n                                setUpdateAxios(true)\n                              }\n                              \n                          })\n                  }\n                })\n        })\n      },[]);\n\n\n      const subscriptionWatched = (index,item) =>\n      {\n        return subscriptions.map(s =>\n          {\n            return s.Movies.map(movies =>\n              {\n                if(movies.movieName === item.Name)\n                {\n                  return members.map(m=>\n                    {\n                      if(s.MemberId === m._id)\n                      {\n                        return <li key = {index}><Link to=\"/main/Subscriptions/AllMembers\">{m.Name}</Link>, {movies.date}</li>\n                      }\n                    })\n                }\n              })\n          })\n      }\n\n      function handleEdit(id,name)\n      {\n        if(updateAxios === true)\n        {\n          history.push(\"/main/movies/EditMovie/\"+id+\"/\"+name)\n        }\n        else\n        {\n          \n        }\n      }\n\n      function handleDelete(id, name)\n      {\n        //delete the movie\n        axios.delete('http://localhost:8000/routingToCinemaWS/deleteMovie/'+id)\n        \n        //delete the movie's subscriptions(only the movie)==> (update)\n        //the code if's - if the movies fount out in one of the subscribers pass only the other movies of the same subscriber\n        let arrOfNotSubscribe = []\n        let mId = \"\"\n        let subId = \"\"\n        subscriptions.forEach(s=>\n          {\n            s.Movies.forEach(m=>\n              {\n                if(m.movieName === name)\n                {\n                  s.Movies.forEach(x =>\n                    {\n                      if(x.movieName !== name)\n                      {\n                        mId = s.MemberId\n                        subId = s._id\n                        arrOfNotSubscribe.push({movieName: x.movieName, date: x.date})\n                      }\n                    })\n                  \n                }\n              })\n          })\n         \n        const unsubscribeMovie = {\n          movies: arrOfNotSubscribe,\n          memberId: mId\n        }\n        console.log(arrOfNotSubscribe)\n        axios.put('http://localhost:8000/routingToCinemaWS/editSubscription/'+subId, unsubscribeMovie)\n        .then(resp=> console.log(resp))\n\n         //reload the page because of the changes\n         window.location.reload(false);\n      }\n\n      const findMovie = () =>\n      {\n        // console.log(find.current.value)\n        let arr = []\n        movies.forEach(x=>\n          {\n            var n = x.Name.startsWith(find.current.value)\n            if(n === true)\n            {\n              arr.push(x)\n            }\n          })\n          setMovies(arr)\n      }\n      \n      const getOnlyYear = (date) =>\n      {\n        let x = date.slice(0,4)\n        return x\n      }\n\n      let items = movies.map((item,index)=>\n      {\n        return <div key= {index} className=\"w3-blue w3-hover-shadow w3-padding-32 w3-bordered w3-code\">\n        <div style = {{display: \"block\"}}>\n        {item.Name}, {getOnlyYear(item.Premiered)}<br/>\n          Genres: {item.Genres.join(\",\")}<br/><br/>\n        </div>\n          \n          <img src= {item.Image} alt=\"movies\" style= {{display: \"inline\", height: \"250px\"}}/>\n          <div className=\"w3-green w3-hover-shadow w3-padding-32 w3-bordered w3-code\" style= {{border: \"3px solid\", \n          display: \"inline-block\", width: \"660px\",   marginLeft: \"10px\" }}>\n            Subscriptions watched\n            <ul>\n              {subscriptionWatched(index,item)}\n            </ul>\n            <Switch>\n            <Route path = \"/main/Subscriptions/AllMembers\" component = {AllMembers}/>\n            </Switch>\n          </div>\n          <br/><br/>\n          <input type =\"button\" value = \"Edit\" onClick = {()=> handleEdit(item._id,item.Name)}/>\n          <input type =\"button\" value = \"Delete\" onClick = {()=> handleDelete(item._id, item.Name)}/>\n\n        </div> \n      })\n\n      \n    return(\n       <div >\n       Find Movie: <input type = \"text\" name = \"find\" ref = {find}/>\n       <input type =\"button\" value = \"Find\" onClick = {findMovie}/> <br/><br/>\n       {items}\n       </div>\n    ) \n}\n\nexport default AllMovies\n"]},"metadata":{},"sourceType":"module"}