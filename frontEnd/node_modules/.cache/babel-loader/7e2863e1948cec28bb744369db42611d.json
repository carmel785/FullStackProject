{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/carmelklein/GitProjects/FullStackProject/frontEnd/src/Components/AllMovies.js\",\n    _s = $RefreshSig$();\n\nimport { UserContext } from './Contexts';\nimport { useContext, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { BrowserRouter as Router, Link, Switch, Route } from 'react-router-dom';\nimport { useHistory } from \"react-router-dom\";\nimport AllMembers from './AllMembers';\n\nconst AllMovies = () => {\n  _s();\n\n  const [movies, setMovies] = useState([]);\n  const [subscriptions, setSubscriptions] = useState([]);\n  const [members, setMembers] = useState([]);\n  let history = useHistory();\n  const context = useContext(UserContext);\n  useEffect(() => {\n    console.log(\"All Movies: \" + context);\n    axios.get('http://localhost:4000/routingToFront/moviesToClient').then(x => {\n      setMovies(x.data);\n    }).catch(error => {\n      console.log(error);\n    }); //getting the subscriptions from the Web Service(DB)\n\n    axios.get('http://localhost:4000/routingToFront/subscriptionToClient').then(x => {\n      setSubscriptions(x.data);\n    }); //getting the members from the Web Service\n\n    axios.get('http://localhost:4000/routingToFront/membersToClient').then(x => {\n      setMembers(x.data);\n    });\n  }, []);\n\n  const subscriptionWatched = (index, item) => {\n    return subscriptions.map(s => {\n      return s.Movies.map(movies => {\n        if (movies.movieName === item.Name) {\n          return members.map(m => {\n            if (s.MemberId === m._id) {\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/main/Subscriptions/AllMembers\",\n                  children: m.Name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 46,\n                  columnNumber: 50\n                }, this), \", \", movies.date]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 46,\n                columnNumber: 32\n              }, this);\n            }\n          });\n        }\n      });\n    });\n  };\n\n  function handleEdit(id, name) {\n    history.push(\"/main/movies/EditMovie/\" + id + \"/\" + name);\n  }\n\n  function handleDelete(id, name) {\n    // //delete the movie\n    // axios.delete('http://localhost:8000/routingToCinemaWS/deleteMovie/'+id)\n    //delete the movie's subscriptions(only the movie)==> (update)\n    let arrOfNotSubscribe = [];\n    subscriptions.forEach(s => {\n      s.Movies.forEach(m => {\n        if (m !== name) {\n          arrOfNotSubscribe.push(m);\n        }\n      });\n    });\n    console.log(arrOfNotSubscribe);\n    const unsubscribeMovie = {\n      movieName: arrOfNotSubscribe,\n      date: data.date,\n      memberId: props.item._id\n    }; // axios.put('http://localhost:8000/routingToCinemaWS/deleteSubscriptions/'+id, unsubscribeMovie)\n    // .then(resp=> console.log(resp))\n    //reload the page because of the changes\n\n    window.location.reload(false);\n  }\n\n  const getOnlyYear = date => {\n    let x = date.slice(0, 4);\n    return x;\n  };\n\n  let items = movies.map((item, index) => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w3-blue w3-hover-shadow w3-padding-32 w3-bordered w3-code\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"block\"\n        },\n        children: [item.Name, \", \", getOnlyYear(item.Premiered), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 51\n        }, this), \"Genres: \", item.Genres.join(\",\"), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 42\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 47\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: item.Image,\n        alt: \"movies\",\n        style: {\n          display: \"inline\",\n          height: \"250px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w3-green w3-hover-shadow w3-padding-32 w3-bordered w3-code\",\n        style: {\n          border: \"3px solid\",\n          display: \"inline-block\",\n          width: \"660px\",\n          marginLeft: \"10px\"\n        },\n        children: [\"Subscriptions watched\", /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: subscriptionWatched(index, item)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          children: /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/main/Subscriptions/AllMembers\",\n            component: AllMembers\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        value: \"Edit\",\n        onClick: () => handleEdit(item._id, item.Name)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        value: \"Delete\",\n        onClick: () => handleDelete(item._id, item.Name)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 16\n    }, this);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"Find Movie: \", /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"find\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"button\",\n      value: \"Find\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 8\n    }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 47\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 52\n    }, this), items]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 8\n  }, this);\n};\n\n_s(AllMovies, \"etssQVBHZdG7385X012g0BTAZvc=\", false, function () {\n  return [useHistory];\n});\n\n_c = AllMovies;\nexport default AllMovies;\n\nvar _c;\n\n$RefreshReg$(_c, \"AllMovies\");","map":{"version":3,"sources":["/Users/carmelklein/GitProjects/FullStackProject/frontEnd/src/Components/AllMovies.js"],"names":["UserContext","useContext","useEffect","useState","axios","BrowserRouter","Router","Link","Switch","Route","useHistory","AllMembers","AllMovies","movies","setMovies","subscriptions","setSubscriptions","members","setMembers","history","context","console","log","get","then","x","data","catch","error","subscriptionWatched","index","item","map","s","Movies","movieName","Name","m","MemberId","_id","date","handleEdit","id","name","push","handleDelete","arrOfNotSubscribe","forEach","unsubscribeMovie","memberId","props","window","location","reload","getOnlyYear","slice","items","display","Premiered","Genres","join","Image","height","border","width","marginLeft"],"mappings":"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","sourcesContent":["import {UserContext} from './Contexts'\nimport {useContext, useEffect, useState} from 'react'\nimport axios from 'axios'\nimport {BrowserRouter as Router, Link , Switch, Route} from 'react-router-dom'\nimport { useHistory } from \"react-router-dom\";\nimport AllMembers from './AllMembers'\n\nconst AllMovies  = () =>\n{\n    const [movies, setMovies] = useState([])\n    const [subscriptions,setSubscriptions] = useState([])\n    const [members,setMembers] = useState([])\n    let history = useHistory();\n\n    const context = useContext(UserContext)\n    \n    useEffect(() => {\n        console.log(\"All Movies: \"+context)\n\n        axios.get('http://localhost:4000/routingToFront/moviesToClient')\n        .then(x=>{(setMovies(x.data))}).catch(error => {console.log(error)}) \n\n       //getting the subscriptions from the Web Service(DB)\n       axios.get('http://localhost:4000/routingToFront/subscriptionToClient')\n       .then(x=>{setSubscriptions(x.data)})\n\n      //getting the members from the Web Service\n      axios.get('http://localhost:4000/routingToFront/membersToClient')\n      .then(x=>{setMembers(x.data)})\n\n      },[]);\n\n\n      const subscriptionWatched = (index,item) =>\n      {\n        return subscriptions.map(s =>\n          {\n            return s.Movies.map(movies =>\n              {\n                if(movies.movieName === item.Name)\n                {\n                  return members.map(m=>\n                    {\n                      if(s.MemberId === m._id)\n                      {\n                        return <li key = {index}><Link to=\"/main/Subscriptions/AllMembers\">{m.Name}</Link>, {movies.date}</li>\n                      }\n                    })\n                }\n              })\n          })\n      }\n     \n\n      function handleEdit(id,name)\n      {\n       history.push(\"/main/movies/EditMovie/\"+id+\"/\"+name)\n      }\n\n      function handleDelete(id, name)\n      {\n        // //delete the movie\n        // axios.delete('http://localhost:8000/routingToCinemaWS/deleteMovie/'+id)\n        \n        //delete the movie's subscriptions(only the movie)==> (update)\n        let arrOfNotSubscribe = []\n        subscriptions.forEach(s=>\n          {\n            s.Movies.forEach(m=>\n              {\n                if(m !== name)\n                {\n                  arrOfNotSubscribe.push(m)\n                }\n              })\n          })\n          console.log(arrOfNotSubscribe)\n        const unsubscribeMovie = {\n          movieName: arrOfNotSubscribe,\n          date: data.date,\n          memberId: props.item._id\n        }\n        // axios.put('http://localhost:8000/routingToCinemaWS/deleteSubscriptions/'+id, unsubscribeMovie)\n        // .then(resp=> console.log(resp))\n\n         //reload the page because of the changes\n         window.location.reload(false);\n      }\n\n      \n      const getOnlyYear = (date) =>\n      {\n        let x = date.slice(0,4)\n        return x\n      }\n\n      let items = movies.map((item,index)=>\n      {\n        return <div key= {index} className=\"w3-blue w3-hover-shadow w3-padding-32 w3-bordered w3-code\">\n        <div style = {{display: \"block\"}}>\n        {item.Name}, {getOnlyYear(item.Premiered)}<br/>\n          Genres: {item.Genres.join(\",\")}<br/><br/>\n        </div>\n          \n          <img src= {item.Image} alt=\"movies\" style= {{display: \"inline\", height: \"250px\"}}/>\n          <div className=\"w3-green w3-hover-shadow w3-padding-32 w3-bordered w3-code\" style= {{border: \"3px solid\", \n          display: \"inline-block\", width: \"660px\",   marginLeft: \"10px\" }}>\n            Subscriptions watched\n            <ul>\n              {subscriptionWatched(index,item)}\n            </ul>\n            <Switch>\n            <Route path = \"/main/Subscriptions/AllMembers\" component = {AllMembers}/>\n            </Switch>\n          </div>\n          <br/><br/>\n          <input type =\"button\" value = \"Edit\" onClick = {()=> handleEdit(item._id,item.Name)}/>\n          <input type =\"button\" value = \"Delete\" onClick = {()=> handleDelete(item._id, item.Name)}/>\n\n        </div> \n      })\n\n      \n    return(\n       <div >\n       Find Movie: <input type = \"text\" name = \"find\" />\n       <input type =\"button\" value = \"Find\"/> <br/><br/>\n       {items}\n       </div>\n    ) \n}\n\nexport default AllMovies\n"]},"metadata":{},"sourceType":"module"}